# åœ¨æœåŠ¡å™¨ä¸Šç›´æ¥ä¿®æ”¹ä»£ç 

## ğŸ”§ ä¿®æ”¹æ­¥éª¤

### åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
# åœæ­¢åå°æœåŠ¡å™¨
pkill -f video_server.py

# åœæ­¢systemdæœåŠ¡
systemctl stop video-server

# å¤‡ä»½æ–‡ä»¶
cp /root/video_server/video_server.py /root/video_server/video_server.py.bak9

# ä¿®æ”¹ä»£ç ï¼šåœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ import sysï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
grep -q "import sys" /root/video_server/video_server.py || sed -i '1a\import sys' /root/video_server/video_server.py

# ä¿®æ”¹printä¸ºsys.stderr.writeï¼ˆç¬¬629-631è¡Œï¼‰
sed -i '629s/print(f"APIåˆ—è¡¨è¯·æ±‚:/sys.stderr.write(f"APIåˆ—è¡¨è¯·æ±‚:/' /root/video_server/video_server.py
sed -i '629s/")/\\n")/' /root/video_server/video_server.py
sed -i '630s/print(f"VIDEO_ROOT:/sys.stderr.write(f"VIDEO_ROOT:/' /root/video_server/video_server.py
sed -i '630s/")/\\n")/' /root/video_server/video_server.py
sed -i '631s/print(f"è·¯å¾„å­˜åœ¨:/sys.stderr.write(f"è·¯å¾„å­˜åœ¨:/' /root/video_server/video_server.py
sed -i '631s/")/\\n")/' /root/video_server/video_server.py

# æ·»åŠ flushï¼ˆåœ¨ç¬¬631è¡Œåï¼‰
sed -i '631a\            sys.stderr.flush()' /root/video_server/video_server.py

# ä¿®æ”¹ç¬¬644è¡Œçš„print
sed -i '644s/print(f"ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶...")/sys.stderr.write(f"ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶...\\n")/' /root/video_server/video_server.py
sed -i '645a\                sys.stderr.flush()' /root/video_server/video_server.py

# ä¿®æ”¹ç¬¬650è¡Œçš„print
sed -i '650s/print(f"æ–‡ä»¶: {f}, æ‰©å±•å:/sys.stderr.write(f"æ–‡ä»¶: {f}, æ‰©å±•å:/' /root/video_server/video_server.py
sed -i '650s/")/\\n")/' /root/video_server/video_server.py
sed -i '651a\                        sys.stderr.flush()' /root/video_server/video_server.py

# ä¿®æ”¹ç¬¬671è¡Œçš„print
sed -i '671s/print(f"æ‰¾åˆ° {len(file_list)} ä¸ªæ–‡ä»¶")/sys.stderr.write(f"æ‰¾åˆ° {len(file_list)} ä¸ªæ–‡ä»¶\\n")/' /root/video_server/video_server.py

# æ£€æŸ¥è¯­æ³•
python3 -m py_compile /root/video_server/video_server.py
```

**æ³¨æ„**ï¼šsedå‘½ä»¤å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œå¦‚æœå‡ºé”™ï¼Œå»ºè®®ä½¿ç”¨Workbenchæ–‡ä»¶ç®¡ç†å™¨ä¸Šä¼ æ–‡ä»¶ã€‚

---

## ğŸ¯ æ›´ç®€å•çš„æ–¹æ³•ï¼šç›´æ¥æµ‹è¯•å½“å‰ä»£ç 

å¦‚æœä¿®æ”¹ä»£ç æœ‰å›°éš¾ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç›´æ¥æµ‹è¯•ï¼Œçœ‹çœ‹èƒ½å¦æ‰¾åˆ°é—®é¢˜ã€‚

### åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
# åœæ­¢åå°æœåŠ¡å™¨
pkill -f video_server.py

# ç›´æ¥æµ‹è¯•APIï¼ˆä½¿ç”¨systemdæœåŠ¡ï¼‰
systemctl start video-server
curl http://localhost:8081/api/list/åŸåˆ›è§†é¢‘ | python3 -m json.tool

# æŸ¥çœ‹æ—¥å¿—
journalctl -u video-server -n 20 --no-pager
```

---

## ğŸ’¡ æ¨è

**å¦‚æœä¿®æ”¹ä»£ç æœ‰å›°éš¾**ï¼Œå…ˆç›´æ¥æµ‹è¯•å½“å‰ä»£ç ï¼Œçœ‹çœ‹APIè¿”å›ä»€ä¹ˆã€‚

---

**å…ˆåœæ­¢åå°æœåŠ¡å™¨ï¼Œç„¶åæµ‹è¯•ï¼** ğŸ”

