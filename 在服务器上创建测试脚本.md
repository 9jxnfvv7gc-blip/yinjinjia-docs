# åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºæµ‹è¯•è„šæœ¬

## ðŸ“ æ­¥éª¤1ï¼šåˆ›å»ºæµ‹è¯•è„šæœ¬

åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
cat > /tmp/test_api_logic.py << 'ENDOFFILE'
#!/usr/bin/env python3
import os
import json

VIDEO_ROOT = '/root/videos'
category = 'åŽŸåˆ›è§†é¢‘'
category_path = os.path.join(VIDEO_ROOT, category)

print(f"category_path: {category_path}")
print(f"è·¯å¾„å­˜åœ¨: {os.path.exists(category_path)}")

videos = []
file_list = []

if os.path.exists(category_path):
    print("ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶...")
    
    video_extensions = ['.mp4', '.mov', '.mkv', '.avi', '.flv', '.wmv', '.webm']
    audio_extensions = ['.mp3', '.wav', '.flac', '.aac', '.m4a', '.ogg', '.wma']
    all_media_extensions = video_extensions + audio_extensions
    
    files = os.listdir(category_path)
    print(f"æ–‡ä»¶æ•°é‡: {len(files)}")
    
    for f in files:
        file_path = os.path.join(category_path, f)
        if os.path.isfile(file_path):
            ext = os.path.splitext(f)[1].lower()
            print(f"æ–‡ä»¶: {f}, æ‰©å±•å: {ext}, åœ¨åˆ—è¡¨ä¸­: {ext in all_media_extensions}")
            
            if ext in all_media_extensions:
                relative_path = os.path.relpath(file_path, VIDEO_ROOT)
                url = f"http://47.243.177.166:8081/{relative_path.replace(os.sep, '/')}"
                
                file_list.append({
                    'title': f,
                    'url': url,
                    'id': f
                })
                print(f"  æ·»åŠ åˆ°file_list: {f}")
    
    print(f"file_listé•¿åº¦: {len(file_list)}")
    print(f"file_listå†…å®¹: {file_list}")
    
    for item in file_list:
        videos.append({
            'title': item['title'],
            'url': item['url'],
            'id': item['id']
        })
    
    print(f"videosé•¿åº¦: {len(videos)}")
    print(f"videoså†…å®¹: {videos}")
    
    result = json.dumps(videos, ensure_ascii=False)
    print(f"JSONç»“æžœ: {result}")
else:
    print(f"ç›®å½•ä¸å­˜åœ¨: {category_path}")
ENDOFFILE
```

---

## ðŸš€ æ­¥éª¤2ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

```bash
python3 /tmp/test_api_logic.py
```

---

## ðŸ“‹ æ­¥éª¤3ï¼šæŸ¥çœ‹ç»“æžœ

æŠŠè¾“å‡ºç»“æžœå‘ç»™æˆ‘ï¼Œæˆ‘ä¼šæ ¹æ®ç»“æžœåˆ¤æ–­é—®é¢˜åœ¨å“ªé‡Œã€‚

---

**å…ˆæ‰§è¡Œæ­¥éª¤1å’Œæ­¥éª¤2ï¼ŒæŠŠç»“æžœå‘ç»™æˆ‘ï¼** ðŸ”

