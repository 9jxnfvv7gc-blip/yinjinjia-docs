# 🚀 启动北京服务器 - 查看视频

## 📋 当前状态

- ✅ 应用已正常启动（不再闪退）
- ✅ 首次使用提示正常显示
- ❌ 没有显示视频（因为服务器未运行或视频不在本地）

## 🎯 解决方案：启动北京服务器

你的视频在北京服务器上（`39.107.137.136`），需要启动服务器。

### 步骤1：连接到北京服务器

#### 方式1：使用阿里云 Workbench（推荐）

1. **打开浏览器**，访问：https://ecs.console.aliyun.com
2. **登录阿里云账号**
3. **找到服务器**：
   - 实例ID: `8336ddd8dbe0433ea562a4b6e5f91da6`
   - IP: `39.107.137.136`
4. **点击"远程连接"** → **"Workbench远程连接"**
5. **输入密码登录**

#### 方式2：使用 SSH（在本地 Mac 终端）

```bash
ssh root@39.107.137.136
# 输入密码
```

### 步骤2：在服务器上启动视频服务器

连接成功后，在服务器终端执行：

```bash
# 1. 设置视频目录
export VIDEO_ROOT="/root/videos"

# 2. 进入脚本目录（根据实际情况调整）
cd /root/app

# 3. 检查 video_server.py 是否存在
ls -la video_server.py

# 4. 如果不存在，需要先上传（在本地 Mac 执行）：
# scp video_server.py root@39.107.137.136:/root/app/

# 5. 启动服务器
nohup python3 video_server.py > /root/server.log 2>&1 &

# 6. 检查是否启动成功
ps aux | grep video_server.py

# 7. 查看日志
tail -f /root/server.log
```

### 步骤3：开放防火墙端口

在服务器上执行：

```bash
# Ubuntu/Debian
sudo ufw allow 8081/tcp
sudo ufw reload

# 检查防火墙状态
sudo ufw status
```

### 步骤4：检查阿里云安全组

1. 登录阿里云控制台
2. 进入 ECS → 安全组
3. 找到服务器的安全组
4. 添加入站规则：
   - **端口范围**: 8081
   - **协议**: TCP
   - **授权对象**: 0.0.0.0/0

### 步骤5：测试服务器

在服务器上测试：

```bash
# 测试本地连接
curl http://localhost:8081/api/categories
curl http://localhost:8081/api/list/原创视频
```

在本地 Mac 测试：

```bash
curl http://39.107.137.136:8081/api/categories
curl http://39.107.137.136:8081/api/list/原创视频
```

### 步骤6：应用已配置好

应用已经配置为使用北京服务器，不需要修改代码。

只需要：
1. 启动北京服务器（按上面的步骤）
2. 在 iPhone 上刷新应用（下拉刷新或重启应用）

## 🔍 快速检查清单

- [ ] 已连接到北京服务器
- [ ] video_server.py 已上传到服务器
- [ ] VIDEO_ROOT 环境变量已设置（`/root/videos`）
- [ ] 服务器已启动（`ps aux | grep video_server.py` 有输出）
- [ ] 防火墙已开放 8081 端口
- [ ] 阿里云安全组已配置
- [ ] 本地可以访问 API（`curl http://39.107.137.136:8081/api/categories`）
- [ ] 应用显示视频列表

## 📝 如果 video_server.py 不存在

如果服务器上没有 `video_server.py`，需要先上传：

在本地 Mac 终端执行：

```bash
cd "/Volumes/Expansion/FlutterProjects/桌面影音播放器_安装包_20251121_165905"
scp video_server.py root@39.107.137.136:/root/app/
```

然后回到服务器，继续步骤2。

## ✅ 完成后的验证

服务器启动后，应用应该：
1. 显示"精选视频"标题
2. 显示你上传的视频列表
3. 点击视频可以播放

如果仍然没有视频，检查：
- 服务器上的视频文件是否存在：`ls -la /root/videos/原创视频`
- 服务器日志是否有错误：`tail -f /root/server.log`


