# 使用本地服务器测试指南

## 问题分析

- ✅ 服务器 `47.243.177.166:8081` 正在运行
- ✅ 从 Mac 可以访问服务器
- ❌ iOS 设备（浏览器和应用）无法访问服务器
- **原因**：网络路由问题，iOS 设备无法访问该 IP

## 解决方案：使用本地服务器

在 Mac 上启动本地服务器，让 iOS 设备通过同一 WiFi 访问。

### 步骤 1：获取 Mac 的本地 IP

你的 Mac 本地 IP 是：**192.168.10.103**

### 步骤 2：启动本地服务器

在终端运行：

```bash
cd "/Volumes/Expansion/FlutterProjects/桌面影音播放器_安装包_20251121_165905"

# 启动本地服务器（使用服务器上的视频目录结构）
# 需要先检查服务器上的视频目录路径
python3 video_server.py
```

或者指定视频目录：

```bash
# 如果有本地视频目录
python3 video_server.py "/path/to/your/videos"
```

### 步骤 3：修改应用配置

修改 `lib/config.dart`，使用本地 IP：

```dart
static String get apiBaseUrl {
  // 开发时使用本地服务器
  return 'http://192.168.10.103:8081';
  // 生产环境使用远程服务器
  // return productionApiUrl;
}
```

### 步骤 4：确保 Mac 和 iOS 设备在同一 WiFi

- Mac 和 iOS 设备必须连接到同一个 WiFi 网络
- 确保防火墙允许 8081 端口

### 步骤 5：测试连接

1. **在 Mac 浏览器测试**：
   ```
   http://192.168.10.103:8081/api/list/原创视频
   ```

2. **在 iOS 设备 Safari 测试**：
   ```
   http://192.168.10.103:8081/api/list/原创视频
   ```

3. **运行应用**：
   ```bash
   flutter run -d Dianhua
   ```

## 注意事项

1. **保持服务器运行**：启动服务器的终端窗口必须保持打开
2. **防火墙设置**：确保 Mac 防火墙允许 8081 端口
3. **网络要求**：Mac 和 iOS 设备必须在同一 WiFi 网络

## 如果仍然无法连接

1. **检查 Mac 防火墙**：
   - 系统设置 → 网络 → 防火墙
   - 确保允许传入连接

2. **检查服务器是否启动**：
   ```bash
   curl http://192.168.10.103:8081
   ```

3. **检查 iOS 设备网络**：
   - 确保连接到正确的 WiFi
   - 尝试重启 WiFi

## 临时方案：使用示例内容

如果无法连接服务器，应用会显示友好的错误信息，并允许重试。


