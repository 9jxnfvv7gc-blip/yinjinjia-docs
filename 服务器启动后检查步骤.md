# ✅ 服务器启动后检查步骤

## 📋 当前状态

- ✅ 已切换到 root 用户
- ✅ 服务器进程正在运行（PID: 54278）
- ⚠️ 需要检查 video_server.py 是否存在

## 🔍 在服务器上执行以下检查

### 步骤1：检查 video_server.py 是否存在

```bash
# 检查文件是否存在
ls -la /root/app/video_server.py

# 如果不存在，需要上传
```

### 步骤2：如果文件不存在，上传它

**在本地 Mac 终端执行：**

```bash
cd "/Volumes/Expansion/FlutterProjects/桌面影音播放器_安装包_20251121_165905"
scp video_server.py admin@39.107.137.136:/tmp/video_server.py
```

**然后在服务器上执行：**

```bash
# 移动文件到 /root/app
mv /tmp/video_server.py /root/app/
chmod +x /root/app/video_server.py
```

### 步骤3：检查服务器日志

```bash
# 查看服务器日志
tail -30 /root/server.log

# 应该看到类似这样的输出：
# 启动视频服务器...
# 端口: 8081
# 视频根目录: /root/videos
```

### 步骤4：检查视频文件位置

```bash
# 检查视频目录
ls -la /root/videos/原创视频/

# 如果目录不存在，创建它
mkdir -p /root/videos/原创视频
mkdir -p /root/videos/原创歌曲
```

### 步骤5：测试服务器 API

```bash
# 测试分类列表
curl http://localhost:8081/api/categories

# 测试视频列表
curl http://localhost:8081/api/list/原创视频

# 应该返回 JSON 格式的视频列表
```

### 步骤6：如果服务器没有正常启动，重启它

```bash
# 停止旧进程
pkill -f video_server.py

# 等待2秒
sleep 2

# 重新启动
cd /root/app
export VIDEO_ROOT="/root/videos"
nohup python3 video_server.py > /root/server.log 2>&1 &

# 检查进程
ps aux | grep video_server.py

# 查看日志
tail -30 /root/server.log
```

## 🌐 在本地 Mac 测试

服务器启动成功后，在本地 Mac 终端执行：

```bash
# 测试分类列表
curl http://39.107.137.136:8081/api/categories

# 测试视频列表
curl http://39.107.137.136:8081/api/list/原创视频
```

如果返回视频列表，说明服务器正常！

## 📱 在 iPhone 上刷新应用

服务器启动后，在 iPhone 上：
1. 下拉刷新应用
2. 或重启应用
3. 应该能看到视频列表了


