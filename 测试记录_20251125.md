# 📋 测试记录（2025-11-25）

## 1. 测试环境
- **测试时间**：2025-11-25 16:10 CST
- **测试人员**：xiaohuihu
- **电脑环境**：macOS 15 (Darwin 25.1.0)，终端 `xiaohuihu@192`
- **移动设备**：`DAR8NRZT8PT4C66P`（Android，开启 USB 调试）
- **服务器**：阿里云香港 `47.243.177.166:8081`
- **APK 版本**：`app-release-视频修复.apk`（文件大小约 47 MB，生成时间 2025-11-25 13:09 CST）
- **服务器代码**：`/root/video_server/video_server.py`（已部署 Range 请求修复版本）

## 2. 测试步骤
1. `adb devices` 确认设备连接。
2. `adb uninstall com.example.video_music_app` 移除旧签名版本。
3. `adb install ~/Desktop/app-release-视频修复.apk` 安装修复版 APK。
4. 通过应用首页加载 `原创视频`、`原创歌曲` 分类列表。
5. 选择以下媒体并播放：
   - `【抖音神曲】2021年抖音超火英文歌曲 - Try to relax - TikTok.mp4`
   - `2021 终极越南鼓串烧 Weekend Remix 抖音2021.mp4`
   - `韩宝仪+-+你潇洒我漂亮.wma`
6. 使用 `./查看视频日志.sh` 收集 logcat，确认无 `T.m: Source error`。

## 3. 结果
- ✅ 分类列表可以正常拉取，接口：`/api/categories`、`/api/list/原创视频`。
- ✅ 视频/音频可正常播放，ExoPlayer 未再出现 `Source error`。
- ✅ `curl -H "Range: bytes=0-1" http://47.243.177.166:8081/video/...` 返回 `206 Partial Content`。
- ✅ iOS 应用已重新编译成功（20.2MB）。
- ✅ iOS 应用闪退问题已解决，应用可以正常启动和运行。
- ✅ Bundle ID 已更新为：`com.xiaohui.videomusicapp`。
- ✅ 签名配置完成（Team: Xiaohui Hu）。

## 4. iOS 测试详情

### 修复过程
1. **清理并重新编译**：
   - `flutter clean` ✅
   - `flutter pub get` ✅
   - `flutter build ios --release` ✅

2. **解决签名问题**：
   - Bundle ID 从 `com.example.videoMusicApp` 改为 `com.xiaohui.videomusicapp` ✅
   - 选择 Team: `Xiaohui Hu` ✅
   - 启用自动签名管理 ✅

3. **修复 iOS 版本警告**：
   - 更新 Podfile，设置 `platform :ios, '13.0'` ✅
   - 统一所有依赖的 deployment target 为 13.0 ✅
   - 重新运行 `pod install` ✅

### 测试结果
- ✅ 应用成功安装到 iPhone
- ✅ 应用正常启动，不再闪退
- ⏳ 功能测试待进行（视频列表、播放等）

## 5. 备注
- 服务器 `video-server-beijing.service` 已启用自动启动。
- 若需复现日志，可运行 `./查看视频日志.sh` 并在手机端播放。
- iOS 项目路径：`ios/Runner.xcworkspace`（不要使用 `videoMusicApp.xcodeproj`）。



