# 🔧 服务器端口占用 - 重启步骤

## ❌ 问题

服务器启动失败：`OSError: [Errno 98] Address already in use`

说明端口 8081 已被占用，需要先停止旧进程。

## ✅ 解决步骤

### 在服务器终端执行（全部复制粘贴）：

```bash
# 1. 停止所有 video_server.py 进程
pkill -9 -f video_server.py

# 2. 等待进程完全停止
sleep 3

# 3. 确认进程已停止（应该没有输出）
ps aux | grep video_server.py | grep -v grep

# 4. 检查端口是否释放
netstat -tlnp | grep 8081 || echo "端口已释放"

# 5. 重新启动服务器
cd /root/app
export VIDEO_ROOT="/root/videos"
nohup python3 video_server.py > /root/server.log 2>&1 &

# 6. 等待启动
sleep 3

# 7. 检查进程（应该看到进程）
ps aux | grep video_server.py | grep -v grep

# 8. 查看日志
tail -20 /root/server.log

# 9. 测试API（应该返回2个视频）
curl http://localhost:8081/api/list/原创视频
```

## ✅ 验证

如果最后一条命令返回包含2个视频的JSON数组，说明服务器启动成功！

然后在本地 Mac 测试：

```bash
curl http://47.243.177.166:8081/api/list/原创视频
```

如果也返回视频列表，说明服务器正常，应用应该可以连接了。

## 📱 运行应用

服务器正常后，在本地 Mac 终端执行：

```bash
cd "/Volumes/Expansion/FlutterProjects/桌面影音播放器_安装包_20251121_165905"
flutter run -d Dianhua
```


