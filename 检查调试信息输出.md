# æ£€æŸ¥è°ƒè¯•ä¿¡æ¯è¾“å‡º

## ğŸ” é—®é¢˜

- âœ… APIè¯·æ±‚å·²æ”¶åˆ°ï¼ˆæ—¥å¿—æ˜¾ç¤º200çŠ¶æ€ç ï¼‰
- âŒ ä½†æ²¡æœ‰çœ‹åˆ°è°ƒè¯•ä¿¡æ¯ï¼ˆprintè¾“å‡ºï¼‰

**å¯èƒ½åŸå› **ï¼š
1. systemdé»˜è®¤ä¸æ•è·printè¾“å‡º
2. éœ€è¦ä½¿ç”¨sys.stderræˆ–loggingæ¨¡å—

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ³•1ï¼šæ£€æŸ¥è°ƒè¯•ä¿¡æ¯æ˜¯å¦å·²æ·»åŠ 

åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
# æ£€æŸ¥è°ƒè¯•ä¿¡æ¯æ˜¯å¦åœ¨æ–‡ä»¶ä¸­
grep -n "ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶" /root/video_server/video_server.py
grep -n "APIåˆ—è¡¨è¯·æ±‚" /root/video_server/video_server.py
```

**å¦‚æœæ‰¾åˆ°äº†**ï¼Œè¯´æ˜è°ƒè¯•ä¿¡æ¯å·²æ·»åŠ ï¼Œä½†è¾“å‡ºæ²¡æœ‰æ˜¾ç¤ºåœ¨æ—¥å¿—ä¸­ã€‚

---

### æ–¹æ³•2ï¼šä¿®æ”¹printä¸ºsys.stderrï¼ˆæ¨èï¼‰

systemdä¼šæ•è·stderrè¾“å‡ºï¼Œæ‰€ä»¥éœ€è¦å°†printæ”¹ä¸ºsys.stderr.writeã€‚

åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
cd /root/video_server

# å¤‡ä»½æ–‡ä»¶
cp video_server.py video_server.py.bak7

# ä¿®æ”¹printä¸ºsys.stderr.writeï¼ˆè¿™æ ·systemdå¯ä»¥æ•è·è¾“å‡ºï¼‰
sed -i 's/print(f"APIåˆ—è¡¨è¯·æ±‚:/import sys\n            sys.stderr.write(f"APIåˆ—è¡¨è¯·æ±‚:/g' video_server.py
sed -i 's/print(f"VIDEO_ROOT:/sys.stderr.write(f"VIDEO_ROOT:/g' video_server.py
sed -i 's/print(f"è·¯å¾„å­˜åœ¨:/sys.stderr.write(f"è·¯å¾„å­˜åœ¨:/g' video_server.py
sed -i 's/print(f"ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶...")/sys.stderr.write(f"ç›®å½•å­˜åœ¨ï¼Œå¼€å§‹æ‰«ææ–‡ä»¶...\\n")/g' video_server.py
sed -i 's/print(f"æ–‡ä»¶: {f}, æ‰©å±•å:/sys.stderr.write(f"æ–‡ä»¶: {f}, æ‰©å±•å:/g' video_server.py
sed -i 's/print(f"æ‰¾åˆ° {len(file_list)} ä¸ªæ–‡ä»¶")/sys.stderr.write(f"æ‰¾åˆ° {len(file_list)} ä¸ªæ–‡ä»¶\\n")/g' video_server.py
```

**æ³¨æ„**ï¼šè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå¤æ‚ï¼Œå¯èƒ½æœ‰é—®é¢˜ã€‚

---

### æ–¹æ³•3ï¼šç›´æ¥æ£€æŸ¥ç›®å½•å’Œæ–‡ä»¶ï¼ˆæœ€ç®€å•ï¼‰

åœ¨Workbenchç»ˆç«¯æ‰§è¡Œï¼š

```bash
# æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨
ls -la /root/videos/åŸåˆ›è§†é¢‘/

# æ£€æŸ¥æ–‡ä»¶
ls /root/videos/åŸåˆ›è§†é¢‘/*.mp4

# æ‰‹åŠ¨æµ‹è¯•Pythonä»£ç 
python3 << 'EOF'
import os
VIDEO_ROOT = '/root/videos'
category = 'åŸåˆ›è§†é¢‘'
category_path = os.path.join(VIDEO_ROOT, category)
print(f"category_path: {category_path}")
print(f"è·¯å¾„å­˜åœ¨: {os.path.exists(category_path)}")
if os.path.exists(category_path):
    files = os.listdir(category_path)
    print(f"æ–‡ä»¶åˆ—è¡¨: {files}")
    for f in files:
        file_path = os.path.join(category_path, f)
        if os.path.isfile(file_path):
            ext = os.path.splitext(f)[1].lower()
            print(f"æ–‡ä»¶: {f}, æ‰©å±•å: {ext}")
EOF
```

---

## ğŸ¯ ç°åœ¨å¯ä»¥æ‰§è¡Œ

1. **æ£€æŸ¥è°ƒè¯•ä¿¡æ¯æ˜¯å¦å·²æ·»åŠ **ï¼ˆ`grep -n "ç›®å½•å­˜åœ¨" /root/video_server/video_server.py`ï¼‰
2. **æ£€æŸ¥ç›®å½•å’Œæ–‡ä»¶**ï¼ˆ`ls -la /root/videos/åŸåˆ›è§†é¢‘/`ï¼‰
3. **æ‰‹åŠ¨æµ‹è¯•Pythonä»£ç **ï¼ˆä¸Šé¢çš„ä»£ç ï¼‰

---

**å…ˆæ£€æŸ¥ç›®å½•å’Œæ–‡ä»¶ï¼Œå‘Šè¯‰æˆ‘ç»“æœï¼** ğŸ”

