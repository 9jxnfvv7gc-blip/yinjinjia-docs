# æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ” ç™»å½•æ–¹å¼

### æ–¹æ³•1ï¼šä½¿ç”¨Workbenchï¼ˆæ¨èï¼Œæ— éœ€å¯†ç ï¼‰

å¦‚æœä½ æœ‰Workbenchè®¿é—®æƒé™ï¼Œè¿™æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š

1. **æ‰“å¼€Workbenchæ–‡ä»¶ç®¡ç†å™¨**
2. **å¯¼èˆªåˆ°æœåŠ¡å™¨ç›®å½•**ï¼š`/root/video_server/`
3. **ä¸Šä¼ æ–‡ä»¶**ï¼š
   - å°†æœ¬åœ°çš„ `video_server.py` æ–‡ä»¶æ‹–æ‹½åˆ°æœåŠ¡å™¨ç›®å½•
   - æˆ–è€…ä½¿ç”¨ä¸Šä¼ åŠŸèƒ½ä¸Šä¼ æ–‡ä»¶

### æ–¹æ³•2ï¼šä½¿ç”¨SSHå¯†é’¥ï¼ˆå¦‚æœå·²é…ç½®ï¼‰

å¦‚æœä½ æœ‰SSHå¯†é’¥ï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```bash
# ä½¿ç”¨SSHå¯†é’¥è¿æ¥ï¼ˆæ— éœ€å¯†ç ï¼‰
ssh -i ~/.ssh/your_key root@47.243.177.166
```

### æ–¹æ³•3ï¼šä½¿ç”¨å¯†ç ç™»å½•

å¦‚æœä½ çŸ¥é“rootå¯†ç ï¼š

```bash
# ç›´æ¥ä½¿ç”¨å¯†ç ç™»å½•
ssh root@47.243.177.166
# ç„¶åè¾“å…¥å¯†ç 
```

### æ–¹æ³•4ï¼šä½¿ç”¨adminç”¨æˆ·ï¼ˆå¦‚æœrootä¸å¯ç”¨ï¼‰

å¦‚æœæœåŠ¡å™¨é…ç½®äº†adminç”¨æˆ·ï¼š

```bash
# ä½¿ç”¨adminç”¨æˆ·ç™»å½•
ssh admin@47.243.177.166

# ç„¶ååˆ‡æ¢åˆ°rootæˆ–ä½¿ç”¨sudo
sudo su -
# æˆ–è€…
sudo cp video_server.py /root/video_server/
```

---

## ğŸ“¤ ä¸Šä¼ æ–‡ä»¶çš„æ–¹æ³•

### æ–¹æ³•Aï¼šä½¿ç”¨Workbenchæ–‡ä»¶ç®¡ç†å™¨ï¼ˆæœ€ç®€å•ï¼‰

1. æ‰“å¼€Workbench
2. å¯¼èˆªåˆ° `/root/video_server/`
3. ä¸Šä¼  `video_server.py` æ–‡ä»¶

### æ–¹æ³•Bï¼šä½¿ç”¨scpï¼ˆéœ€è¦å¯†ç æˆ–å¯†é’¥ï¼‰

```bash
cd "/Volumes/Expansion/FlutterProjects/æ¡Œé¢å½±éŸ³æ’­æ”¾å™¨_å®‰è£…åŒ…_20251121_165905"

# ä½¿ç”¨å¯†ç ï¼ˆä¼šæç¤ºè¾“å…¥å¯†ç ï¼‰
scp video_server.py root@47.243.177.166:/root/video_server/

# æˆ–ä½¿ç”¨adminç”¨æˆ·
scp video_server.py admin@47.243.177.166:/tmp/
# ç„¶åSSHç™»å½•åç§»åŠ¨æ–‡ä»¶
```

### æ–¹æ³•Cï¼šä½¿ç”¨rsyncï¼ˆå¦‚æœå·²é…ç½®ï¼‰

```bash
rsync -avz video_server.py root@47.243.177.166:/root/video_server/
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1ï¼šå¤‡ä»½ç°æœ‰æ–‡ä»¶

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š
```bash
# å¤‡ä»½ç°æœ‰æ–‡ä»¶
cp /root/video_server/video_server.py /root/video_server/video_server.py.bak.$(date +%Y%m%d_%H%M%S)
```

### æ­¥éª¤2ï¼šä¸Šä¼ æ–°æ–‡ä»¶

ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ä¹‹ä¸€ä¸Šä¼  `video_server.py` åˆ° `/root/video_server/`

### æ­¥éª¤3ï¼šé‡å¯æœåŠ¡å™¨

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š
```bash
# åœæ­¢ç°æœ‰æœåŠ¡å™¨
pkill -f video_server.py
systemctl stop video-server 2>/dev/null || true

# é‡æ–°å¯åŠ¨æœåŠ¡å™¨
cd /root/video_server
python3 video_server.py > /tmp/video_server.log 2>&1 &

# ç­‰å¾…2ç§’
sleep 2

# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨
ps aux | grep video_server.py | grep -v grep

# æŸ¥çœ‹æ—¥å¿—
tail -20 /tmp/video_server.log
```

### æ­¥éª¤4ï¼šæµ‹è¯•

```bash
# æµ‹è¯•API
curl "http://localhost:8081/api/list/åŸåˆ›è§†é¢‘" | head -20

# æµ‹è¯•è§†é¢‘URLï¼ˆä½¿ç”¨ç¼–ç åçš„URLï¼‰
curl -I "http://localhost:8081/video/%E5%8E%9F%E5%88%9B%E8%A7%86%E9%A2%91/%E5%84%8B%E5%B7%9E%E7%B2%BD%E5%AD%90.mp4"
```

---

## ğŸ” å¦‚æœé‡åˆ°æƒé™é—®é¢˜

### é—®é¢˜1ï¼šPermission denied

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨adminç”¨æˆ·ç™»å½•ï¼Œç„¶åä½¿ç”¨sudo
- æˆ–è€…æ£€æŸ¥SSHå¯†é’¥é…ç½®
- æˆ–è€…ä½¿ç”¨Workbenchæ–‡ä»¶ç®¡ç†å™¨

### é—®é¢˜2ï¼šæ‰¾ä¸åˆ°ç›®å½•

**æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ç›®å½•æ˜¯å¦å­˜åœ¨
ls -la /root/video_server/

# å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºç›®å½•
mkdir -p /root/video_server
```

### é—®é¢˜3ï¼šæ— æ³•å¯åŠ¨æœåŠ¡å™¨

**æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python3 --version

# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /root/video_server/video_server.py

# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -tuln | grep 8081
```

---

## ğŸ“ å¿«é€Ÿéƒ¨ç½²è„šæœ¬

å¦‚æœä½ æœ‰SSHè®¿é—®æƒé™ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªéƒ¨ç½²è„šæœ¬ï¼š

```bash
#!/bin/bash
# deploy_server.sh

SERVER="root@47.243.177.166"
SERVER_DIR="/root/video_server"
LOCAL_FILE="video_server.py"

echo "ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨..."
scp "$LOCAL_FILE" "$SERVER:$SERVER_DIR/"

echo "é‡å¯æœåŠ¡å™¨..."
ssh "$SERVER" << 'EOF'
cd /root/video_server
pkill -f video_server.py
python3 video_server.py > /tmp/video_server.log 2>&1 &
sleep 2
ps aux | grep video_server.py | grep -v grep
echo "æœåŠ¡å™¨å·²é‡å¯"
EOF

echo "éƒ¨ç½²å®Œæˆï¼"
```

ä½¿ç”¨æ–¹æ³•ï¼š
```bash
chmod +x deploy_server.sh
./deploy_server.sh
```

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

**å¦‚æœä½ æœ‰Workbenchè®¿é—®æƒé™**ï¼š
1. âœ… ä½¿ç”¨Workbenchæ–‡ä»¶ç®¡ç†å™¨ä¸Šä¼ æ–‡ä»¶ï¼ˆæœ€ç®€å•ï¼‰
2. âœ… åœ¨Workbenchç»ˆç«¯æ‰§è¡Œé‡å¯å‘½ä»¤

**å¦‚æœæ²¡æœ‰Workbenchï¼Œä½†æœ‰SSHè®¿é—®**ï¼š
1. âœ… ä½¿ç”¨SSHå¯†é’¥ï¼ˆå¦‚æœå·²é…ç½®ï¼‰
2. âœ… æˆ–ä½¿ç”¨å¯†ç ç™»å½•
3. âœ… æˆ–ä½¿ç”¨adminç”¨æˆ· + sudo

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** å‘Šè¯‰æˆ‘ä½ æœ‰å“ªäº›è®¿é—®æ–¹å¼ï¼Œæˆ‘å¯ä»¥æä¾›æ›´å…·ä½“çš„æŒ‡å¯¼ï¼










