# 🎯 远程桌面代理共享方案（2025-11-26）

## 📋 你的情况

- ✅ Mac 电脑
- ✅ 安装了 Windows App（远程桌面应用）
- ✅ 通过远程桌面连接到香港服务器（47.243.177.166）
- ✅ 在远程桌面的图形界面中访问 Google
- ✅ 想让 iPhone 也能访问 Google

---

## 🔍 豆包方法分析

豆包说："在 Mac 上把远程桌面的香港节点代理共享到局域网"

**这个方法有个问题**：
- 远程桌面（Windows App）只是连接到远程服务器
- Mac 本身并没有连接到香港服务器
- 远程桌面中的网络连接是在远程服务器上的，不是 Mac 本地的

**正确的理解应该是**：
- 需要在 Mac 上建立代理服务，转发到香港服务器
- 或者直接在远程桌面（Ubuntu）上开启代理服务，但需要让 iPhone 能访问

---

## ✅ 可行方案

### 方案1：Mac 安装 ClashX Pro（推荐）

#### 核心思路
- Mac 安装 ClashX Pro，配置连接香港服务器
- Mac 开启局域网共享
- iPhone 通过 Mac 的内网 IP 连接代理

#### 步骤1：在 Mac 上安装 ClashX Pro

1. **下载 ClashX Pro**：
   - 访问：https://github.com/yichengchen/clashX/releases
   - 下载最新版本（.dmg 文件）
   - 安装到 Mac

#### 步骤2：配置 ClashX Pro 使用香港服务器

由于你已经有香港服务器（47.243.177.166）和 Squid 代理（端口 3128），可以：

1. **打开 ClashX Pro**
2. **创建配置文件**：
   - 点击菜单栏的 ClashX Pro 图标
   - 选择"配置" → "打开配置文件夹"
   - 创建一个新文件：`hongkong.yaml`

3. **编辑配置文件**：
   ```yaml
   port: 7890
   socks-port: 7891
   allow-lan: true
   mode: rule
   log-level: info
   
   proxies:
     - name: "HongKong-Squid"
       type: http
       server: 47.243.177.166
       port: 3128
   
   proxy-groups:
     - name: "Proxy"
       type: select
       proxies:
         - "HongKong-Squid"
   
   rules:
     - MATCH,Proxy
   ```

4. **保存配置文件**
5. **在 ClashX Pro 中选择这个配置**
6. **点击"设置为系统代理"**

#### 步骤3：测试 Mac 访问 Google

1. **在 Mac 上打开浏览器**
2. **访问**：`https://www.google.com`
3. **确认可以访问**

#### 步骤4：开启局域网共享

1. **打开 ClashX Pro 偏好设置**：
   - 点击菜单栏的 ClashX Pro 图标
   - 选择"偏好设置"

2. **开启局域网连接**：
   - ✅ 勾选"允许局域网连接"
   - 记录 HTTP 端口（7890）
   - 记录 SOCKS5 端口（7891）

3. **查看 Mac 内网 IP**：
   ```bash
   ipconfig getifaddr en0
   ```
   - 记录这个 IP（例如：192.168.1.105）

4. **防火墙放行**（如果需要）：
   - 系统设置 → 网络 → 防火墙 → 选项
   - 允许 ClashX Pro 入站连接

#### 步骤5：配置 iPhone Wi-Fi 代理

1. **打开 iPhone 设置 → Wi-Fi**
2. **点击当前连接的 Wi-Fi 网络**（点击 ⓘ 图标）
3. **向下滚动到"HTTP 代理"**
4. **选择"手动"**
5. **填写**：
   - 服务器：Mac 的内网 IP（例如：192.168.1.105）
   - 端口：7890
   - 认证：关闭
6. **保存并返回**

#### 步骤6：测试 iPhone 访问 Google

1. **在 iPhone 上打开 Safari**
2. **访问**：`http://ipinfo.io`
3. **确认 IP 已切换**（应该显示香港 IP）
4. **访问**：`https://accounts.google.com/signup`
5. **看是否能打开**

---

### 方案2：在远程桌面（Ubuntu）上开启代理服务

#### 核心思路
- 在远程桌面（Ubuntu）上安装 Clash 或 3Proxy
- 开启局域网监听（但远程桌面在云端，iPhone 无法直接连接）
- **需要 Mac 作为中转**：Mac 连接到远程桌面的代理，再共享给 iPhone

#### 步骤1：在远程桌面（Ubuntu）上安装 Clash

```bash
# SSH 连接到远程桌面服务器
ssh desktop@47.243.177.166

# 下载 Clash
cd /tmp
wget https://github.com/Dreamacro/clash/releases/download/v1.18.0/clash-linux-amd64-v1.18.0.gz
gunzip clash-linux-amd64-v1.18.0.gz
chmod +x clash-linux-amd64-v1.18.0
sudo mv clash-linux-amd64-v1.18.0 /usr/local/bin/clash
```

#### 步骤2：配置 Clash 监听公网（不推荐，安全风险）

**注意**：这种方法有安全风险，不推荐。

#### 步骤3：Mac 连接远程代理并共享（复杂，不推荐）

这种方法比较复杂，需要 Mac 作为中转。

---

## 🎯 推荐方案

### 方案1：Mac + ClashX Pro（最简单、最稳定）

**优势**：
- ✅ 配置简单
- ✅ 稳定可靠
- ✅ 支持多协议
- ✅ 图形化界面

**步骤**：
1. Mac 安装 ClashX Pro
2. 配置使用香港服务器（47.243.177.166:3128）
3. 开启局域网共享
4. iPhone 配置 Wi-Fi 代理

---

## 📝 操作步骤总结

### 推荐：Mac + ClashX Pro

1. ✅ **在 Mac 上安装 ClashX Pro**
2. ✅ **创建配置文件，使用 Squid 代理**（47.243.177.166:3128）
3. ✅ **测试 Mac 访问 Google**
4. ✅ **开启局域网共享**（端口 7890）
5. ✅ **iPhone 配置 Wi-Fi 代理**（Mac 内网 IP + 7890）
6. ✅ **测试 iPhone 访问 Google**

---

## 🔍 为什么豆包的方法需要调整

豆包说"在 Mac 上把远程桌面的香港节点代理共享"，但：
- 远程桌面只是连接到服务器，Mac 本身没有代理
- 需要在 Mac 上建立代理服务，转发到香港服务器

**正确的方法**：
- Mac 安装 ClashX Pro，配置连接香港服务器
- Mac 开启局域网共享
- iPhone 通过 Mac 访问

---

## 🎯 现在请操作

1. **在 Mac 上安装 ClashX Pro**
2. **创建配置文件**（使用上面的 YAML 内容）
3. **测试 Mac 访问 Google**
4. **开启局域网共享**
5. **iPhone 配置 Wi-Fi 代理**
6. **测试 iPhone 访问 Google**

如果遇到问题，告诉我，我可以协助排查。

---

**最后更新**：2025-11-26  
**推荐**：Mac + ClashX Pro（最简单、最稳定）








