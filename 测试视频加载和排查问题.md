# 测试视频加载和排查问题

## 🔍 排查步骤

### 步骤1：检查服务器返回的URL格式

在Workbench终端执行：

```bash
# 测试API，查看返回的URL格式
curl http://localhost:8081/api/list/原创视频
```

**应该返回**：JSON格式，例如：
```json
[{
  "title": "视频名称",
  "url": "/video/原创视频/视频名称.mp4",
  "id": "/root/videos/原创视频/视频名称.mp4"
}]
```

---

### 步骤2：测试视频文件是否可以访问

在Workbench终端执行：

```bash
# 查看服务器上的视频文件
ls -lh /root/videos/原创视频/

# 测试视频文件是否可以访问（替换为实际文件名）
# 注意：URL需要编码中文字符
curl -I "http://localhost:8081/video/原创视频/视频名称.mp4"
```

**应该返回**：HTTP 200 状态码和 `Content-Type: video/mp4`

---

### 步骤3：在Mac上测试外部访问

在你的Mac终端执行：

```bash
# 测试API
curl http://47.243.177.166:8081/api/list/原创视频

# 测试视频文件访问（替换为实际文件名）
# 注意：URL需要编码中文字符
curl -I "http://47.243.177.166:8081/video/原创视频/视频名称.mp4"
```

**应该返回**：HTTP 200 状态码

---

### 步骤4：查看应用调试输出

在运行应用的终端中，查看调试输出：

**应该看到**：
```
视频播放器初始化，路径: http://47.243.177.166:8081/video/原创视频/视频名称.mp4
使用网络URL播放: http://47.243.177.166:8081/video/原创视频/视频名称.mp4
```

**如果看到错误**：
```
视频初始化失败: [错误信息]
错误类型: [错误类型]
视频路径: [路径]
```

---

## 🔧 可能的问题和解决方案

### 问题1：URL编码问题

**现象**：URL包含中文字符，可能无法正确访问

**解决方案**：服务器应该自动处理URL编码，但可以检查：
- 确保URL格式正确
- 确保中文字符正确编码

---

### 问题2：CORS问题

**检查**：服务器是否正确配置了CORS

**解决方案**：检查 `video_server.py` 中的CORS配置（应该已经配置）

---

### 问题3：视频格式不支持

**检查**：视频文件格式是否被支持

**解决方案**：确保视频格式为 `.mp4`, `.mov`, `.avi` 等常见格式

---

### 问题4：网络连接问题

**检查**：应用是否能访问服务器

**解决方案**：
- 检查网络连接
- 检查服务器是否运行
- 检查安全组配置

---

## 🎯 现在可以执行

1. **检查服务器返回的URL格式**（`curl http://localhost:8081/api/list/原创视频`）
2. **测试视频文件是否可以访问**（`curl -I "http://localhost:8081/video/原创视频/文件名.mp4"`）
3. **查看应用调试输出**（终端中的日志）
4. **告诉我具体的错误信息**，我会帮你进一步排查

---

## 💡 提示

- **查看终端输出**，看是否有详细的错误信息
- **检查URL格式**，确保URL正确
- **测试文件访问**，确保服务器能正确提供文件

---

**先执行排查步骤，告诉我结果和具体的错误信息！** 🔍

